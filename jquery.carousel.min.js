/*! jQuery Carousel Plugin by Thomas Jaggi (2013) - http://github.com/backflip/jquery-carousel/ */
(function(g,h,f,c){var d="carousel",e={animation:{duration:300,step:1},behavior:{circular:false,autoplay:0,pauseAutoplayOnHover:true,keyboardNav:true,resetInitialStylesOnDestroy:false},layout:{horizontal:true,groupedHandles:true,fixedHeight:true,responsive:true,visibleSlides:1,gutter:0},elements:{prevNext:true,handles:true,counter:true},events:{start:false,stop:false},initialSlide:0,text:{next:"show next slide",prev:"show previous slide",counter:"%current% of %total%",handle:"%index%"},touch:{enabled:true,thresholds:{speed:0.4,distance:0.3}},$syncedCarousels:null},j={getTransitionProperty:function(){var r=h.body||h.documentElement,t="transition",q,o=["Moz","ms","O","Webkit"],s=r.style;if(typeof s[t]==="string"){return t}t=t.charAt(0).toUpperCase()+t.substr(1);for(var p=0;p<o.length;p++){q=o[p]+t;if(typeof s[q]==="string"){return q}}return false},getTransitionEndEvent:function(){var o=j.getTransitionProperty(),p={transition:"transitionend",MozTransition:"transitionend",msTransition:"msTransitionEnd",OTransition:"oTransitionEnd",WebkitTransition:"webkitTransitionEnd"};return p[o]||false},getNamespacedEvents:function(q){var o=q.split(" ");for(var p=0;p<o.length;p++){o[p]=o[p]+"."+d}return o.join(" ")},enableButton:function(o){o.removeClass("state-disabled").removeAttr("aria-disabled").attr("tabindex",0)},disableButton:function(o){o.addClass("state-disabled").attr("aria-disabled",true).attr("tabindex",-1)}},k={touch:"ontouchstart" in g,transition:j.getTransitionProperty()},m=j.getNamespacedEvents(!k.touch?"click keydown":"touchstart"),n="carouselUpdate",l=false,b=false,a=0;var i=function(p,o){this.$dom={slider:f(p),slides:f(p).children(),container:f('<div class="'+d+'-container" />'),frame:f('<div class="'+d+'-frame" />'),navContainer:f('<div class="'+d+'-nav" aria-hidden="true" />'),prev:f('<span class="'+d+'-prev" role="button" tabindex="0" />'),next:f('<span class="'+d+'-next" role="button" tabindex="0" />'),counter:f('<div class="'+d+'-counter" aria-hidden="true" />'),handlesContainer:f('<div class="'+d+'-handles" aria-hidden="true" />'),handles:null,handle:f('<span class="'+d+'-handle" role="button" tabindex="0" />')};this.props={currentDomIndex:0,currentSlideIndex:0,total:0,visible:0};this.state={enabled:false,animating:false};this.settings=f.extend(true,{},o,this.$dom.slider.data(d+"-options"))};i.prototype={init:function(){var p=this,o=this.$dom,q=null,r;if(this.$dom.slider.data(d)||this.$dom.slider.length===0){return this}this.index=a++;this.settings=f.extend(true,{},e,this.settings);if(this.settings.resetInitialStylesOnDestroy){r=this._getStyles(o.slider);o.slider.data(d+"-css",r);o.slides.each(function(){var t=f(this),s=p._getStyles(t);t.data(d+"-css",s)})}o.container.insertBefore(o.slider);o.frame.appendTo(o.container).append(o.slider.addClass(d+"-slider"));if(this.settings.elements.prevNext){o.prev.appendTo(o.navContainer).text(this.settings.text.prev);o.next.appendTo(o.navContainer).text(this.settings.text.next);o.navContainer.appendTo(o.container);o.nav=o.prev.add(o.next)}if(this.settings.elements.counter){o.counter.appendTo(o.container)}if(this.settings.elements.handles){o.handlesContainer.appendTo(o.container)}o.slides.addClass(d+"-slide");if(this.settings.behavior.circular){o.slides.each(function(s){f(this).data(d+"-index",s)})}if(!this.settings.layout.horizontal){o.container.addClass(d+"-vertical")}this.update();if(this.settings.layout.responsive){f(g).on(j.getNamespacedEvents("resize")+this.index,f.proxy(function(){if(q){clearTimeout(q)}q=setTimeout(f.proxy(function(){this.resize()},this),100)},this))}if(this.settings.$syncedCarousels){this.$dom.slider.on(n,f.proxy(function(s,t){this.goTo(t.index,false,true)},this))}o.slider.data(d,this);return this},update:function(p){var o=this;f.extend(true,this.settings,p);this.$dom.slides=this.$dom.slides.parent().children();this.props.total=this.$dom.slides.length;this.props.currentDomIndex=(this.props.currentDomIndex>this.props.total)?this.props.total:this.props.currentDomIndex;this.props.currentSlideIndex=(this.props.currentSlideIndex>this.props.total)?this.props.total:this.props.currentDomIndex;this.props.visible=this._getVisibleSlides();if(this.settings.elements.handles){this.$dom.handlesContainer.html(this._getHandles());this.$dom.handles=this.$dom.handlesContainer.children()}this.resize();this.disable();this.enable()},resize:function(){var t=this.$dom.frame.width(),s,u=this.settings.layout.gutter,r=u?(this.settings.layout.horizontal?{"margin-left":0.5*u,"margin-right":0.5*u}:{"margin-top":0.5*u,"margin-bottom":0.5*u}):{},p=this.settings.layout.horizontal?Math.floor(t/this.props.visible):t,o,q=this.settings.layout.horizontal?this.props.total*(p+u):p;this.$dom.slides.outerWidth(p).css(r);this.$dom.slider.width(q).height("auto");if(this.settings.layout.fixedHeight){o=this._getHighestSlide();this.$dom.slides.css("min-height",o);s=this.settings.layout.horizontal?o:this.props.visible*(o+u);this.$dom.frame.height(s)}this.goTo(this.props.currentDomIndex,true)},enable:function(){var o=this;if(this.state.enabled||this.props.visible>this.props.total){return}if(this.settings.elements.prevNext){this.$dom.nav.on(m,function(r){var t=f(this),p=t.hasClass("state-disabled"),q,s,u;if(p){return}q=t.is(o.$dom.next)?1:-1;s=q*o.settings.animation.step+o.props.currentDomIndex;u=function(){o.goTo(s)};o._handleButtonEvents(r,t,u)})}if(this.settings.elements.handles){this.$dom.handles.on(m,function(p){var r=f(this),t=r.data(d+"-handle-index")||r.index(),q=o._getCurrentSlideIndex(t),s=function(){o.goTo(q)};o._handleButtonEvents(p,r,s)})}if(this.settings.touch.enabled&&k.touch){this._touchEnable()}if(this.settings.behavior.keyboardNav){this.$dom.container.on(j.getNamespacedEvents("keydown"),f.proxy(function(t){var q=f(t.target),w=q.get(0).nodeName.toLowerCase(),p=f.inArray(w,["input","textarea"])!==-1,v=false;if(!(p||t.metaKey||t.ctrlKey)){var s=t.keyCode||t.which,r,u;if(f.inArray(s,[37,80])!==-1){this.prev();this.$dom.prev.focus();v=true}else{if(f.inArray(s,[39,78])!==-1){this.next();this.$dom.next.focus();v=true}else{if(47<s&&s<58){r=s-49;u=o._getCurrentSlideIndex(r);this.goTo(u);if(this.settings.elements.handles){this.$dom.handles.eq(r).focus()}v=true}}}}if(v){this._autoplayDisable();t.preventDefault()}},this))}if(this.settings.behavior.autoplay){this._autoplayEnable();if(this.settings.behavior.pauseAutoplayOnHover){this.$dom.container.on(j.getNamespacedEvents("mouseenter"),f.proxy(function(p){this._autoplayDisable()},this));this.$dom.container.on(j.getNamespacedEvents("mouseleave"),f.proxy(function(p){this._autoplayEnable()},this))}}this.state.enabled=true;this._updateNav();if(!this.settings.layout.fixedHeight){this._updateHeight()}},disable:function(o){if(!this.state.enabled){return}if(this.settings.elements.prevNext){this.$dom.nav.off(m)}if(this.settings.elements.handles){this.$dom.handles.off(m)}if(this.settings.touch.enabled&&k.touch){this._touchDisable()}if(this.settings.behavior.keyboardNav){this.$dom.container.off(j.getNamespacedEvents("keydown"))}if(this.settings.behavior.autoplay){this._autoplayDisable()}this.state.enabled=false;this._updateNav();if(!this.settings.layout.fixedHeight){this._updateHeight()}},goTo:function(u,x,r){var A=this,v=this._getValidatedTarget(u),p=this._getOriginalSlideIndex(v),t=this._getTargetPosition(v),s=x?0:this.settings.animation.duration,z=function(){if(A.settings.events.stop){A.settings.events.stop(v,p)}A.state.animating=false},q,o,B,w,y;if(!x){this.state.animating=true;if(this.settings.events.start){this.settings.events.start(v,p)}if(!k.transition){this.$dom.slider.animate(t,s,function(){z()})}else{q=k.transition;o=this.settings.layout.horizontal?"left":"top";B=j.getNamespacedEvents(j.getTransitionEndEvent());y=this.$dom.slider.css(q);w=o+" "+s/1000+"s ease-in-out";this.$dom.slider.css(q,w);this.$dom.slider.css(t);this.$dom.slider.on(B,function(){A.$dom.slider.off(B);A.$dom.slider.css(q,y);z()})}if(this.settings.$syncedCarousels&&!r){this.settings.$syncedCarousels.trigger(n,{index:v})}}else{this.$dom.slider.css(t)}this.props.currentDomIndex=v;this.props.currentSlideIndex=p;this._updateNav();if(!this.settings.layout.fixedHeight){this._updateHeight()}},next:function(){this.goTo(this.props.currentDomIndex+this.settings.animation.step)},prev:function(){this.goTo(this.props.currentDomIndex-this.settings.animation.step)},destroy:function(){var o=this.$dom,p;o.slider.removeClass(d+"-slider").removeData(d).insertAfter(o.container);o.slides.removeClass(d+"-slide").removeData(d+"-index");if(this.settings.resetInitialStylesOnDestroy){p=o.slider.data(d+"-css");o.slider.css(p).removeData(d+"-css");o.slides.each(function(){var r=f(this),q=r.data(d+"-css");r.css(q).removeData(d+"-css")})}else{o.slider.removeAttr("style");o.slides.removeAttr("style")}o.container.remove();this.state.enabled=false;this.props.currentDomIndex=0;this.props.currentSlideIndex=0;f(g).off(j.getNamespacedEvents("resize")+this.index)},_autoplayEnable:function(){this.autoplay=setInterval(f.proxy(function(){this.next()},this),this.settings.behavior.autoplay)},_autoplayDisable:function(){clearInterval(this.autoplay);this.autoplay=null},_handleButtonEvents:function(q,o,r){switch(q.type){case"keydown":if(!(q.metaKey||q.ctrlKey)){var p=q.keyCode||q.which;if(f.inArray(p,[13,32])!==-1){r();q.preventDefault()}}break;case"touchstart":l=false;o.on("touchmove."+d,function(){l=true});o.on("touchend."+d,function(){o.off("touchmove."+d);o.off("touchend."+d);if(!l){r()}});break;default:r();break}if(this.settings.behavior.autoplay){this._autoplayDisable()}},_getHandles:function(){var p=h.createDocumentFragment(),t;if(!this.settings.layout.groupedHandles){for(var r=0;r<this.props.total;r++){var u=this.settings.text.handle.replace("%index%",(r+1)),s=this.$dom.handle.clone().text(u).get(0);p.appendChild(s)}}else{t=this.props.total/this.props.visible;for(var r=0;r<t;r++){var o=r*this.props.visible+1,q=(r+1)*this.props.visible,v=this.$dom.handle.clone(),s,u;if(q>this.props.total){q=this.props.total}if(o<q){u=o+" - "+q}else{u=q}u=this.settings.text.handle.replace("%index%",u);s=v.text(u).data(d+"-handle-index",o-1).get(0);p.appendChild(s)}}return f(p)},_getHighestSlide:function(q){var o=0,p=this.$dom.slides;if(q){p=p.filter(q)}p.each(function(){var r=f(this).css("min-height",0).outerHeight();if(r>o){o=r}});return o},_getOriginalSlideIndex:function(o){var p=o;if(this.settings.behavior.circular){p=this.$dom.slides.eq(o).data(d+"-index")}return p},_getCurrentSlideIndex:function(p){var o=p;if(this.settings.behavior.circular){this.$dom.slides.each(function(){var r=f(this),s=r.index(),q=r.data(d+"-index");if(p===q){o=s;return false}})}return o},_getStyles:function(o){var r=["height","left","min-height","top","width"],q={},s;for(var p=0;p<r.length;p++){q[r[p]]=o.css(r[p])}if(k.transition){s=k.transition.charAt(0).toLowerCase()+k.transition.substr(1);q[s]=o.css(s)}return q},_getTargetPosition:function(o){var r=this.settings.layout.horizontal?this.$dom.slides.outerWidth():this.$dom.slides.outerHeight(),q=this.settings.layout.gutter,s=this.settings.layout.horizontal?"left":"top",p={};p[s]=-(o*(r+q)+0.5*q);return p},_getValidatedTarget:function(q){if(!this.settings.behavior.circular){if(q<0){q=0}else{if(q>=(this.props.total-this.props.visible)){q=this.props.total-this.props.visible}}}else{if(q<0){var o=this.props.total+q;if(this._shiftSlides(o,-1)){return 0}}else{if(this.props.total>this.props.visible&&q>(this.props.total-this.props.visible)){var p=(q-1)-(this.props.total-this.props.visible);if(this._shiftSlides(p,1)){return q-(p+1)}}}}return q},_getVisibleSlides:function(){if(this.settings.layout.visibleSlides>0){return this.settings.layout.visibleSlides}else{var o=this,p=0,q=this.settings.layout.horizontal?this.$dom.frame.width():this.$dom.frame.height();this.$dom.slides.each(function(){var r=o.settings.layout.horizontal?f(this).outerWidth():f(this).outerHeight();if(r>p){p=r}});return Math.round(q/p)}},_shiftSlides:function(q,p){var o=(p===-1)?":gt("+(q-1)+")":":lt("+(q+1)+")",u=this.$dom.slides.filter(o);if(u.length>0){var s=this.settings.layout.horizontal?"left":"top",v=this.settings.layout.horizontal?this.$dom.slides.outerWidth():this.$dom.slides.outerHeight(),t=this.$dom.slider.position(),r={};r[s]=t[s]+p*u.length*v;if(p===-1){u.prependTo(this.$dom.slider)}else{u.appendTo(this.$dom.slider)}this.$dom.slides=this.$dom.slider.children();this.$dom.slider.css(r);return true}else{return false}},_touchEnable:function(){var o=this,r={start:{x:0,y:0},end:{x:0,y:0}},u={start:0,end:0},t={distance:o.settings.touch.thresholds.distance*o.$dom.frame.width(),speed:o.settings.touch.thresholds.speed*o.$dom.frame.width()},s={top:0,left:0},p={};function q(){var v={x:r.end.x-r.start.x,y:r.end.y-r.start.y};if(!o.settings.layout.horizontal){v={x:v.y,y:v.x}}return v}p["touchstart."+d]=function(w){var v=w.originalEvent.targetTouches[0];r.start.x=v.pageX;r.start.y=v.pageY;s=o.$dom.slider.position();u.start=new Date().getTime();l=false;b=false};p["touchmove."+d]=function(z){if(b&&!l){return}var y=z.originalEvent.targetTouches[0],A=0,w={},v=o.settings.layout.horizontal?"left":"top",x;r.end.x=y.pageX;r.end.y=y.pageY;A=q();if(Math.abs(A.x)>Math.abs(A.y)||l){x=o.settings.layout.horizontal?s.left:s.top;w[v]=x+A.x;o.$dom.slider.css(w);if(o.settings.$syncedCarousels){o.settings.$syncedCarousels.css(w)}l=true;z.preventDefault()}else{b=true}};p["touchend."+d]=function(A){if(!l||b){return}var w=A.originalEvent.targetTouches[0],C=q(),y,B=o.props.currentDomIndex;if(Math.abs(C.x)>Math.abs(C.y)){u.end=new Date().getTime();y=Math.abs(C.x)/(u.end-u.start)*1000;if(Math.abs(C.x)>t.distance||y>t.speed){var v=o.settings.layout.horizontal?o.$dom.slides.outerWidth():o.$dom.slides.outerHeight(),x=(C.x>0)?-1:1,z=Math.abs(Math.round(C.x/v));if(z<1&&y>t.speed){z=1}B=o.props.currentDomIndex+x*z}o.goTo(B);if(o.settings.behavior.autoplay){o._autoplayDisable()}}};this.$dom.frame.on(p)},_touchDisable:function(){this.$dom.frame.off(j.getNamespacedEvents("touchstart touchmove touchend"))},_updateNav:function(){if(this.state.enabled){if(this.settings.elements.prevNext){j.enableButton(this.$dom.prev);j.enableButton(this.$dom.next);if(!this.settings.behavior.circular){if(this.props.currentDomIndex===0){j.disableButton(this.$dom.prev)}else{j.enableButton(this.$dom.prev)}if(this.props.currentDomIndex===this.props.total-this.props.visible){j.disableButton(this.$dom.next)}else{j.enableButton(this.$dom.next)}}}if(this.settings.elements.handles){var o=this._getOriginalSlideIndex(this.props.currentDomIndex),p=(o>0)?":gt("+(o-1)+"):lt("+this.props.visible+")":":lt("+(o+this.props.visible)+")";if(this.settings.layout.groupedHandles){p=":eq("+Math.ceil(o/this.props.visible)+")"}j.enableButton(this.$dom.handles);this.$dom.handles.removeClass("state-current");this.$dom.handles.filter(p).addClass("state-current")}}else{if(this.settings.elements.prevNext){j.disableButton(this.$dom.prev);j.disableButton(this.$dom.next)}if(this.settings.elements.handles){j.disableButton(this.$dom.handles)}}if(this.settings.elements.counter){var q=this._getOriginalSlideIndex(this.props.currentDomIndex)+1,s=q+(this.props.visible-1),r;if(this.props.visible>1){if(s>this.props.total){s=this.props.total}q+="-"+s}r=this.settings.text.counter.replace("%current%",q).replace("%total%",this.props.total);this.$dom.counter.text(r)}},_updateHeight:function(){var p=this.props.currentDomIndex,q=p+this.props.visible,s=(p>0)?":gt("+(p-1)+"):lt("+this.props.visible+")":":lt("+(q)+")",r=this._getHighestSlide(),o=this._getHighestSlide(s);this.$dom.slides.css("min-height",r);this.$dom.frame.animate({height:o},this.settings.animation.duration,f.proxy(function(){this.$dom.slides.css("min-height",o)},this))}};f.fn[d]=function(p){var o=arguments;return this.each(function(){var r=f(this),q=r.data(d);if(q){if(typeof p==="object"){q.update.apply(q,o)}else{q[p].apply(q,Array.prototype.slice.call(o,1))}}else{new i(this,p).init()}})};g[d.charAt(0).toUpperCase()+d.substr(1)]=i})(window,document,jQuery);