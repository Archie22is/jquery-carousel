/*! jQuery Carousel Plugin by Thomas Jaggi (2013) - http://github.com/backflip/jquery-carousel/ */
(function(f,g,e,b){var c="carousel",d={animation:{duration:300,step:1},behavior:{horizontal:true,circular:false,autoplay:0,pauseAutoplayOnHover:true,keyboardNav:true,groupedHandles:true,fixedHeight:true},elements:{prevNext:true,handles:true,counter:true},events:{start:false,stop:false},initialSlide:0,text:{next:"show next slide",prev:"show previous slide",counter:"%current% of %total%",handle:"%index%"},touch:{enabled:true,thresholds:{speed:0.4,distance:0.3}},visibleSlides:1,$syncedCarousels:null,resetInitialStylesOnDestroy:false},i={getTransitionProperty:function(){var q=g.body||g.documentElement,s="transition",p,n=["Moz","ms","O","Webkit"],r=q.style;if(typeof r[s]==="string"){return s}s=s.charAt(0).toUpperCase()+s.substr(1);for(var o=0;o<n.length;o++){p=n[o]+s;if(typeof r[p]==="string"){return p}}return false},getTransitionEndEvent:function(){var n=i.getTransitionProperty(),o={transition:"transitionend",MozTransition:"transitionend",msTransition:"msTransitionEnd",OTransition:"oTransitionEnd",WebkitTransition:"webkitTransitionEnd"};return o[n]||false},getNamespacedEvents:function(p){var n=p.split(" ");for(var o=0;o<n.length;o++){n[o]=n[o]+"."+c}return n.join(" ")},enableButton:function(n){n.removeClass("state-disabled").removeAttr("aria-disabled").attr("tabindex",0)},disableButton:function(n){n.addClass("state-disabled").attr("aria-disabled",true).attr("tabindex",-1)}},k={touch:"ontouchstart" in f,transition:i.getTransitionProperty()},l=i.getNamespacedEvents(!k.touch?"click keydown":"touchstart"),m="carouselUpdate",j=false,a=0;var h=function(o,n){this.$dom={slider:e(o),slides:e(o).children(),container:e('<div class="'+c+'-container" tabindex="0" />'),frame:e('<div class="'+c+'-frame" />'),navContainer:e('<div class="'+c+'-nav" aria-hidden="true" />'),prev:e('<span class="'+c+'-prev" role="button" tabindex="0" />'),next:e('<span class="'+c+'-next" role="button" tabindex="0" />'),counter:e('<div class="'+c+'-counter" aria-hidden="true" />'),handlesContainer:e('<div class="'+c+'-handles" aria-hidden="true" />'),handles:null,handle:e('<span class="'+c+'-handle" role="button" tabindex="0" />')};this.props={currentDomIndex:0,currentSlideIndex:0,total:0,visible:0};this.state={enabled:false,animating:false};this.settings=e.extend(true,{},n,this.$dom.slider.data(c+"-options"))};h.prototype={init:function(){var o=this,n=this.$dom,p=null,q;if(this.$dom.slider.data(c)||this.$dom.slider.length===0){return this}this.index=a++;this.settings=e.extend(true,{},d,this.settings);if(this.settings.resetInitialStylesOnDestroy){q=this._getStyles(n.slider);n.slider.data(c+"-css",q);n.slides.each(function(){var s=e(this),r=o._getStyles(s);s.data(c+"-css",r)})}n.container.insertBefore(n.slider);n.frame.appendTo(n.container).append(n.slider.addClass(c+"-slider"));if(this.settings.elements.prevNext){n.prev.appendTo(n.navContainer).text(this.settings.text.prev);n.next.appendTo(n.navContainer).text(this.settings.text.next);n.navContainer.appendTo(n.container);n.nav=n.prev.add(n.next)}if(this.settings.elements.counter){n.counter.appendTo(n.container)}if(this.settings.elements.handles){n.handlesContainer.appendTo(n.container)}n.slides.addClass(c+"-slide");if(this.settings.behavior.circular){n.slides.each(function(r){e(this).data(c+"-index",r)})}if(!this.settings.behavior.horizontal){n.container.addClass(c+"-vertical")}this.update();e(f).on(i.getNamespacedEvents("resize")+this.index,e.proxy(function(){if(p){clearTimeout(p)}p=setTimeout(e.proxy(function(){this.resize()},this),100)},this));if(this.settings.$syncedCarousels){this.$dom.slider.on(m,e.proxy(function(r,s){this.goTo(s.index,false,true)},this))}n.slider.data(c,this);return this},update:function(o){var n=this;e.extend(true,this.settings,o);this.$dom.slides=this.$dom.slides.parent().children();this.props.total=this.$dom.slides.length;this.props.currentDomIndex=this.settings.initialSlide;this.props.currentSlideIndex=this.settings.initialSlide;this.props.visible=this._getVisibleSlides();if(this.settings.elements.handles){this.$dom.handlesContainer.html(this._getHandles());this.$dom.handles=this.$dom.handlesContainer.children()}this.resize();this.disable();this.enable()},resize:function(){var r=this.$dom.frame.width(),q,o=this.settings.behavior.horizontal?Math.floor(r/this.props.visible):r,n,p=this.settings.behavior.horizontal?this.props.total*o:o;this.$dom.slides.outerWidth(o);this.$dom.slider.width(p).height("auto");if(this.settings.behavior.fixedHeight){n=this._getHighestSlide();this.$dom.slides.css("min-height",n);q=this.settings.behavior.horizontal?n:this.props.visible*n;this.$dom.frame.height(q)}this.goTo(this.props.currentDomIndex,true)},enable:function(){var n=this;if(this.state.enabled||this.props.visible>this.props.total){return}if(this.settings.elements.prevNext){this.$dom.nav.on(l,function(q){var s=e(this),o=s.hasClass("state-disabled"),p,r,t;if(o){return}p=s.is(n.$dom.next)?1:-1;r=p*n.settings.animation.step+n.props.currentDomIndex;t=function(){n.goTo(r)};n._handleButtonEvents(q,s,t)})}if(this.settings.elements.handles){this.$dom.handles.on(l,function(o){var q=e(this),s=q.data(c+"-handle-index")||q.index(),p=n._getCurrentSlideIndex(s),r=function(){n.goTo(p)};n._handleButtonEvents(o,q,r)})}if(this.settings.touch.enabled&&k.touch){this._touchEnable()}if(this.settings.behavior.keyboardNav){this.$dom.container.on(i.getNamespacedEvents("keydown"),e.proxy(function(s){var p=e(s.target),v=p.get(0).nodeName.toLowerCase(),o=e.inArray(v,["input","textarea"])!==-1,u=false;if(!(o||s.metaKey||s.ctrlKey)){var r=s.keyCode||s.which,q,t;if(e.inArray(r,[37,80])!==-1){this.prev();this.$dom.prev.focus();u=true}else{if(e.inArray(r,[39,78])!==-1){this.next();this.$dom.next.focus();u=true}else{if(47<r&&r<58){q=r-49;t=n._getCurrentSlideIndex(q);this.goTo(t);if(this.settings.elements.handles){this.$dom.handles.eq(q).focus()}u=true}}}}if(u){this._autoplayDisable();s.preventDefault()}},this))}if(this.settings.behavior.autoplay){this._autoplayEnable();if(this.settings.behavior.pauseAutoplayOnHover){this.$dom.container.on(i.getNamespacedEvents("mouseenter"),e.proxy(function(o){this._autoplayDisable()},this));this.$dom.container.on(i.getNamespacedEvents("mouseleave"),e.proxy(function(o){this._autoplayEnable()},this))}}this.state.enabled=true;this._updateNav();if(!this.settings.behavior.fixedHeight){this._updateHeight()}},disable:function(n){if(!this.state.enabled){return}if(this.settings.elements.prevNext){this.$dom.nav.off(l)}if(this.settings.elements.handles){this.$dom.handles.off(l)}if(this.settings.touch.enabled&&k.touch){this._touchDisable()}if(this.settings.behavior.keyboardNav){this.$dom.container.off(i.getNamespacedEvents("keydown"))}if(this.settings.behavior.autoplay){this._autoplayDisable()}this.state.enabled=false;this._updateNav();if(!this.settings.behavior.fixedHeight){this._updateHeight()}},goTo:function(t,w,q){var z=this,u=this._getValidatedTarget(t),o=this._getOriginalSlideIndex(u),s=this._getTargetPosition(u),r=w?0:this.settings.animation.duration,y=function(){if(z.settings.events.stop){z.settings.events.stop(u,o)}z.state.animating=false},p,n,A,v,x;if(!w){this.state.animating=true;if(this.settings.events.start){this.settings.events.start(u,o)}if(!k.transition){this.$dom.slider.animate(s,r,function(){y()})}else{p=k.transition;n=this.settings.behavior.horizontal?"left":"top";A=i.getNamespacedEvents(i.getTransitionEndEvent());x=this.$dom.slider.css(p);v=n+" "+r/1000+"s ease-in-out";this.$dom.slider.css(p,v);this.$dom.slider.css(s);this.$dom.slider.on(A,function(){z.$dom.slider.off(A);z.$dom.slider.css(p,x);y()})}if(this.settings.$syncedCarousels&&!q){this.settings.$syncedCarousels.trigger(m,{index:u})}}else{this.$dom.slider.css(s)}this.props.currentDomIndex=u;this.props.currentSlideIndex=o;this._updateNav();if(!this.settings.behavior.fixedHeight){this._updateHeight()}},next:function(){this.goTo(this.props.currentDomIndex+this.settings.animation.step)},prev:function(){this.goTo(this.props.currentDomIndex-this.settings.animation.step)},destroy:function(){var n=this.$dom,o;n.slider.removeClass(c+"-slider").removeData(c).insertAfter(n.container);n.slides.removeClass(c+"-slide").removeData(c+"-index");if(this.settings.resetInitialStylesOnDestroy){o=n.slider.data(c+"-css");n.slider.css(o).removeData(c+"-css");n.slides.each(function(){var q=e(this),p=q.data(c+"-css");q.css(p).removeData(c+"-css")})}else{n.slider.removeAttr("style");n.slides.removeAttr("style")}n.container.remove();this.state.enabled=false;this.props.currentDomIndex=0;this.props.currentSlideIndex=0;e(f).off(i.getNamespacedEvents("resize")+this.index)},_autoplayEnable:function(){this.autoplay=setInterval(e.proxy(function(){this.next()},this),this.settings.behavior.autoplay)},_autoplayDisable:function(){clearInterval(this.autoplay);this.autoplay=null},_handleButtonEvents:function(p,n,q){switch(p.type){case"keydown":if(!(p.metaKey||p.ctrlKey)){var o=p.keyCode||p.which;if(e.inArray(o,[13,32])!==-1){q();p.preventDefault()}}break;case"touchstart":j=false;n.on("touchmove."+c,function(){j=true});n.on("touchend."+c,function(){n.off("touchmove."+c);n.off("touchend."+c);if(!j){q()}});break;default:q();break}if(this.settings.behavior.autoplay){this._autoplayDisable()}},_getHandles:function(){var o=g.createDocumentFragment(),s;if(!this.settings.behavior.groupedHandles){for(var q=0;q<this.props.total;q++){var t=this.settings.text.handle.replace("%index%",(q+1)),r=this.$dom.handle.clone().text(t).get(0);o.appendChild(r)}}else{s=this.props.total/this.props.visible;for(var q=0;q<s;q++){var n=q*this.props.visible+1,p=(q+1)*this.props.visible,u=this.$dom.handle.clone(),r,t;if(p>this.props.total){p=this.props.total}if(n<p){t=n+" - "+p}else{t=p}t=this.settings.text.handle.replace("%index%",t);r=u.text(t).data(c+"-handle-index",n-1).get(0);o.appendChild(r)}}return e(o)},_getHighestSlide:function(p){var n=0,o=this.$dom.slides;if(p){o=o.filter(p)}o.each(function(){var q=e(this).css("min-height",0).outerHeight();if(q>n){n=q}});return n},_getOriginalSlideIndex:function(n){var o=n;if(this.settings.behavior.circular){o=this.$dom.slides.eq(n).data(c+"-index")}return o},_getCurrentSlideIndex:function(o){var n=o;if(this.settings.behavior.circular){this.$dom.slides.each(function(){var q=e(this),r=q.index(),p=q.data(c+"-index");if(o===p){n=r;return false}})}return n},_getStyles:function(n){var q=["height","left","min-height","top","width"],p={},r;for(var o=0;o<q.length;o++){p[q[o]]=n.css(q[o])}if(k.transition){r=k.transition.charAt(0).toLowerCase()+k.transition.substr(1);p[r]=n.css(r)}return p},_getTargetPosition:function(n){var p=this.settings.behavior.horizontal?this.$dom.slides.outerWidth():this.$dom.slides.outerHeight(),q=this.settings.behavior.horizontal?"left":"top",o={};o[q]=-n*p;return o},_getValidatedTarget:function(p){if(!this.settings.behavior.circular){if(p<0){p=0}else{if(p>=(this.props.total-this.props.visible)){p=this.props.total-this.props.visible}}}else{if(p<0){var n=this.props.total+p;if(this._shiftSlides(n,-1)){return 0}}else{if(this.props.total>this.props.visible&&p>(this.props.total-this.props.visible)){var o=(p-1)-(this.props.total-this.props.visible);if(this._shiftSlides(o,1)){return p-(o+1)}}}}return p},_getVisibleSlides:function(){if(this.settings.visibleSlides>0){return this.settings.visibleSlides}else{var n=this,o=0,p=this.settings.behavior.horizontal?this.$dom.frame.width():this.$dom.frame.height();this.$dom.slides.each(function(){var q=n.settings.behavior.horizontal?e(this).outerWidth():e(this).outerHeight();if(q>o){o=q}});return Math.round(p/o)}},_shiftSlides:function(p,o){var n=(o===-1)?":gt("+(p-1)+")":":lt("+(p+1)+")",t=this.$dom.slides.filter(n);if(t.length>0){var r=this.settings.behavior.horizontal?"left":"top",u=this.settings.behavior.horizontal?this.$dom.slides.outerWidth():this.$dom.slides.outerHeight(),s=this.$dom.slider.position(),q={};q[r]=s[r]+o*t.length*u;if(o===-1){t.prependTo(this.$dom.slider)}else{t.appendTo(this.$dom.slider)}this.$dom.slides=this.$dom.slider.children();this.$dom.slider.css(q);return true}else{return false}},_touchEnable:function(){var n=this,q={start:{x:0,y:0},end:{x:0,y:0}},t={start:0,end:0},s={distance:n.settings.touch.thresholds.distance*n.$dom.frame.width(),speed:n.settings.touch.thresholds.speed*n.$dom.frame.width()},r={top:0,left:0},o={};function p(){var u={x:q.end.x-q.start.x,y:q.end.y-q.start.y};if(!n.settings.behavior.horizontal){u={x:u.y,y:u.x}}return u}o["touchstart."+c]=function(v){var u=v.originalEvent.targetTouches[0];q.start.x=u.pageX;q.start.y=u.pageY;r=n.$dom.slider.position();t.start=new Date().getTime();j=false};o["touchmove."+c]=function(y){var x=y.originalEvent.targetTouches[0],z=0,v={},u=n.settings.behavior.horizontal?"left":"top",w;q.end.x=x.pageX;q.end.y=x.pageY;z=p();if(Math.abs(z.x)>Math.abs(z.y)){w=n.settings.behavior.horizontal?r.left:r.top;v[u]=w+z.x;n.$dom.slider.css(v);if(n.settings.$syncedCarousels){n.settings.$syncedCarousels.css(v)}j=true;y.preventDefault()}};o["touchend."+c]=function(z){if(!j){return}var v=z.originalEvent.targetTouches[0],B=p(),x,A=n.props.currentDomIndex;if(Math.abs(B.x)>Math.abs(B.y)){t.end=new Date().getTime();x=Math.abs(B.x)/(t.end-t.start)*1000;if(Math.abs(B.x)>s.distance||x>s.speed){var u=n.settings.behavior.horizontal?n.$dom.slides.outerWidth():n.$dom.slides.outerHeight(),w=(B.x>0)?-1:1,y=Math.abs(Math.round(B.x/u));if(y<1&&x>s.speed){y=1}A=n.props.currentDomIndex+w*y}n.goTo(A);if(n.settings.behavior.autoplay){n._autoplayDisable()}}};this.$dom.frame.on(o)},_touchDisable:function(){this.$dom.frame.off(i.getNamespacedEvents("touchstart touchmove touchend"))},_updateNav:function(){if(this.state.enabled){if(this.settings.elements.prevNext){i.enableButton(this.$dom.prev);i.enableButton(this.$dom.next);if(!this.settings.behavior.circular){if(this.props.currentDomIndex===0){i.disableButton(this.$dom.prev)}else{i.enableButton(this.$dom.prev)}if(this.props.currentDomIndex===this.props.total-this.props.visible){i.disableButton(this.$dom.next)}else{i.enableButton(this.$dom.next)}}}if(this.settings.elements.handles){var n=this._getOriginalSlideIndex(this.props.currentDomIndex),o=(n>0)?":gt("+(n-1)+"):lt("+this.props.visible+")":":lt("+(n+this.props.visible)+")";if(this.settings.behavior.groupedHandles){o=":eq("+Math.ceil(n/this.props.visible)+")"}i.enableButton(this.$dom.handles);this.$dom.handles.removeClass("state-current");this.$dom.handles.filter(o).addClass("state-current")}}else{if(this.settings.elements.prevNext){i.disableButton(this.$dom.prev);i.disableButton(this.$dom.next)}if(this.settings.elements.handles){i.disableButton(this.$dom.handles)}}if(this.settings.elements.counter){var p=this._getOriginalSlideIndex(this.props.currentDomIndex)+1,r=p+(this.props.visible-1),q;if(this.props.visible>1){if(r>this.props.total){r=this.props.total}p+="-"+r}q=this.settings.text.counter.replace("%current%",p).replace("%total%",this.props.total);this.$dom.counter.text(q)}},_updateHeight:function(){var o=this.props.currentDomIndex,p=o+this.props.visible,q=(o>0)?":gt("+(o-1)+"):lt("+this.props.visible+")":":lt("+(p)+")",n=this._getHighestSlide(q);this.$dom.frame.animate({height:n},this.settings.animation.duration);this.$dom.slides.css("min-height",n)}};e.fn[c]=function(o){var n=arguments;return this.each(function(){var q=e(this),p=q.data(c);if(p){if(typeof o==="object"){p.update.apply(p,n)}else{p[o].apply(p,Array.prototype.slice.call(n,1))}}else{new h(this,o).init()}})};f[c.charAt(0).toUpperCase()+c.substr(1)]=h})(window,document,jQuery);